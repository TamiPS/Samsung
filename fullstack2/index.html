<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="style.css">
    <title>Prueba de laboratorio</title>
</head>

<body>
    <h1>Formulario Información Alta Telefónica</h1>
    <form action="./procesarFormulario.php" name="telefonica">
        <fieldset>
            <legend>Datos Personales</legend>
            Nombre: <input type="text" class="campo" name="nombre" maxlength="30" /><br />
            Apellidos: <input type="text" class="campo" name="apellidos" maxlength="60" /><br />
            Dirección: <input type="text" class="campo" name="direccion" maxlength="60" /><br />
            Codigo Postal: <input type="text" class="campo" id="cpostal" pattern="[0-9]{5}" onkeyup="checkCP()" /><br />
            Provincia: <input type="text" class="campo" id="provincia" onkeyup="checkProvincia()" /><br />
            <p id="innerProv"></p>
            <p id="innerCp"></p>
        </fieldset>
        <br />
        <fieldset>
            <legend>Tipo de Contratación</legend>
            <input type="radio" name="tipoc" value="nuevo" checked="checked">Nueva Contratación
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="radio" name="tipoc" value="porta">Portabilidad &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="radio" name="tipoc" value="cambio">Cambio de Contrato
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><br />
            Elija la compañía actual:
            <select name="origen">
                <option value="movistar">Movistar</option>
                <option value="orange">Orange</option>
                <option value="vodafone">Vodafone</option>
                <option value="yoigo">Yoigo</option>
                <option value="ninguna">No tengo ninguna compañía</option>
            </select>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            En caso de portabilidad, elija la nueva compañía:
            <select name="origen">
                <option value="movistar">Movistar</option>
                <option value="orange">Orange</option>
                <option value="vodafone">Vodafone</option>
                <option value="yoigo">Yoigo</option>
            </select>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        </fieldset>
        <fieldset>
            <legend>Datos Bancarios</legend>
            <label>País: <input type="text" class="campo" name="pais" value="ES" readonly="readonly" /> (sólo válido
                ES)</label><br />
            <label>Control IBAN: <input type="text" class="campo" id="ciban" placeholder="XX" pattern="[0-9]{2}" /> (dos
                dígitos)</label><br />
            <label>Entidad: <input type="text" class="campo" id="enti" placeholder="XXXX" pattern="[0-9]{4}" /> (cuatro
                dígitos)</label><br />
            <label>Sucursal: <input type="text" class="campo" id="suc" placeholder="XXXX" pattern="[0-9]{4}" /> (cuatro
                dígitos)</label><br />
            <label> DC: <input type="text" class="campo" id="dc" placeholder="XX" /> (dos dígitos)</label><br />
            <label>Cuenta: <input type="text" class="campo" id="cuenta" placeholder="XXXXXXXXXX" pattern="[0-9]{10}" />
                (diez dígitos)</label><br />
        </fieldset>
        <fieldset>
            <legend>Datos Estadísticos ¿Cómo nos conoció?</legend>
            <input type="checkbox" id="tv" name="tv" value="tv">
            <label for="tv"> A través de la TV</label><br />
            <input type="checkbox" id="radio" name="radio" value="radio">
            <label for="radio"> A través de la radio</label><br />
            <input type="checkbox" id="internet" name="internet" value="internet">
            <label for="internet"> A través de Internet</label><br />
            <input type="checkbox" id="otros" name="otros" value="otros">
            <label for="otros"> Otros</label><br />
            <br />
            <input type="range" id="valoracion" min="1" max="4">
            <label for="valoracion">Valoración [1-4]</label><br />
            <br />
            <label for="fecha">Fecha de Encuesta:</label>
            <input type="date" id="fecha" name="fecha" value="2019-01-01">
        </fieldset>
        <input type="submit" value="Enviar Datos" />
        <input type="reset" value="Borrar Datos" />
        <br />
        <button type="button" class="infoButton" onclick="fvaloracion()">Mostrar Valoración</button>
        <button type="button" class="infoButton" onclick="fcuenta()">Mostrar Cuenta</button>
        <button type="button" class="infoButton" onclick="ffecha()">Mostrar Día Semana</button>
    </form>

    <script>
        function fvaloracion() {
            let valoracion = document.getElementById("valoracion").value
            alert('Has valorado con ' + valoracion + ' puntos')
        }
        function fcuenta() {
            let pais = document.getElementsByName("pais")[0].value
            let ciban = document.getElementById("ciban")
            let enti = document.getElementById("enti")
            let suc = document.getElementById("suc")
            let dc = document.getElementById("dc")
            let cuenta = document.getElementById("cuenta")
            alert('Le informamos que su cuenta bancaria es: ' + pais + ciban.value + '-' + enti.value + '-' + suc.value + '-' + dc.value + cuenta.value)
        }
        function ffecha() {
            const dias = [
                'domingo',
                'lunes',
                'martes',
                'miércoles',
                'jueves',
                'viernes',
                'sábado',
            ];
            let fecha = document.getElementById("fecha").value
            let numeroDia = new Date(fecha).getDay();
            let nombreDia = dias[numeroDia];
            alert('La fecha seleccionada en el elemento de fechas es un ' + nombreDia)
        }

        function checkProvincia() {
            var cp = [
                "Alava",
                "Albacete",
                "Alicante",
                "Almeria",
                "Avila",
                "Badajoz",
                "Islas Baleares",
                "Barcelona",
                "Burgos",
                "Caceres",
                "Cadiz",
                "Castellon",
                "Ciudad Real",
                "Cordoba",
                "La Coruna",
                "Cuenca",
                "Gerona",
                "Granada",
                "Guadalajara",
                "Guipuzcoa",
                "Huelva",
                "Huesca",
                "Jaen",
                "Leon",
                "Lerida",
                "La Rioja",
                "Lugo",
                "Madrid",
                "Malaga",
                "Murcia",
                "Navarra",
                "Orense",
                "Asturias",
                "Palencia",
                "Las Palmas",
                "Pontevedra",
                "Salamanca",
                "Santa Cruz de Tenerife",
                "Cantabria",
                "Segovia",
                "Sevilla",
                "Soria",
                "Tarragona",
                "Teruel",
                "Toledo",
                "Valencia",
                "Valladolid",
                "Vizcaya",
                "Zamora",
                "Zaragoza",
                "Ceuta",
                "Melilla"
            ]

            document.getElementById("innerProv").innerHTML = "";
            let provinciaInput = document.getElementById("provincia").value
            let cpIndex = cp.indexOf(provinciaInput) + 1
            let cpInput = document.getElementById("cpostal").value
            let cpIni = cpInput.substr(-5, 2)

            if (cpIndex < 10) {
                console.log("cpIndex < 10")
                cpIndex = '0' + cpIndex
            }

            if (provinciaInput == '') {
                console.log("Debe rellenar el campo provincia")
                document.getElementById("innerProv").style.color = "red"
                document.getElementById("innerProv").innerHTML = "Debe rellenar el campo provincia";
            }
            else if (!cp.includes(provinciaInput)) {
                console.log("La provincia no existe, recuerde que no debe contener acentos ni ñ y la primera letra debe ser mayúscula")
                document.getElementById("innerProv").style.color = "red"
                document.getElementById("innerProv").innerHTML = "La provincia no existe, recuerde que no debe contener acentos ni ñ y la primera letra debe ser mayúscula";
            }
            else if (cpIndex != cpIni) {
                console.log("El Codigo Postal no coincide con la provincia")
                document.getElementById("innerProv").style.color = "red"
                document.getElementById("innerProv").innerHTML = "El Codigo Postal no coincide con la provincia";
            }
            else {
                document.getElementById("innerProv").style.color = "green"
                document.getElementById("innerProv").innerHTML = "El código postal coincide con la provincia";
                console.log("green de provi")
            }
        }
        function checkCP() {
            document.getElementById("innerCp").style.color = "red"
            document.getElementById("innerCp").innerHTML = "Debe rellenar el código postal";
            let checkCP = document.getElementById("cpostal").value
            if (checkCP == '') {
                document.getElementById("innerCp").style.color = "red"
                document.getElementById("innerCp").innerHTML = "Debe rellenar el código postal";
            }
            else if (checkCP.length != 5) {
                document.getElementById("innerCp").style.color = "red"
                document.getElementById("innerCp").innerHTML = "El código postal debe contener 5 digitos";
            }
            else if (isNaN(checkCP)) {
                document.getElementById("innerCp").style.color = "red"
                document.getElementById("innerCp").innerHTML = "El código postal debe contener digitos numéricos";
            }
            else if (checkCP == '') {
                document.getElementById("innerCp").style.color = "red"
                document.getElementById("innerCp").innerHTML = "Debe rellenar el código postal";
            } else {
                document.getElementById("innerCp").style.color = "green"
                document.getElementById("innerCp").innerHTML = "Código postal válido";
            }
        }
    </script>

</body>

</html